# Â© 2022 Nokia.


name: lab13

mgmt:
  network: clab_gNMI
  ipv4-subnet: 172.100.20.0/24


topology:
  defaults:
    #kind: srl
    kind: vr-sros

  kinds:
    srl:
      image: ghcr.io/nokia/srlinux
    vr-sros:
      image: vrnetlab/vr-sros:22.10.R6
      license: /home/sysadmin/clabs/labs_nathan/licence_vSIM_R22_ICC.txt

  nodes:
    #spine1:
    #spine2:
    #leaf1:
    #leaf2:
    #leaf3:
    #leaf4:

    gnmic:
      kind: linux
      mgmt-ipv4: 172.100.20.2
      image: docker-proxy-asis-ghcr.repos.tech.orange/openconfig/gnmic:0.34.2
      binds:
        - ./gnmic.yaml:/app/gnmic.yaml:ro
        - /var/run/docker.sock:/var/run/docker.sock
      cmd: '--config /app/gnmic.yaml --log subscribe'

    influxdb:
      kind: linux
      mgmt-ipv4: 172.100.20.3
      image: dockerproxy.repos.tech.orange/influxdb:1.8
      ports:
        - 8080:8086
      env:
        INFLUXDB_DATA_ENGINE: tsm1
        INFLUXDB_REPORTING_DISABLED: "false"
        INFLUXDB_USER: gnmic
        INFLUXDB_USER_PASSWORD: gnmic
        INFLUXDB_DB: telemetry

    grafana:
      kind: linux
      mgmt-ipv4: 172.100.20.4
      image: grafana/grafana:latest
      binds:
        - grafana/datasources/datasource.yaml:/etc/grafana/provisioning/datasources/datasource.yaml:ro
        #- grafana/dashboards/:/var/lib/grafana/dashboards
      ports:
        - 8082:3000

    R1_7:
      kind: vr-sros
      mgmt-ipv4: 172.100.20.5
      type: "cp: cpu=2 min_ram=4 chassis=sr-7 slot=A card=cpm5 ___ lc: cpu=4 min_ram=4
        max_nics=10 chassis=sr-7 slot=1 card=iom4-e-b mda/1=me10-10gb-sfp+"
      startup-config: ./clab-lab13/R1_7/tftpboot/config.txt


  links:
    # spine1 links
    #- endpoints: ["spine1:e1-1", "leaf1:e1-1"]
    #- endpoints: ["spine1:e1-2", "leaf2:e1-1"]
    #- endpoints: ["spine1:e1-3", "leaf3:e1-1"]
    #- endpoints: ["spine1:e1-4", "leaf4:e1-1"]
    # spine2 links
    #- endpoints: ["spine2:e1-1", "leaf1:e1-2"]
    #- endpoints: ["spine2:e1-2", "leaf2:e1-2"]
    #- endpoints: ["spine2:e1-3", "leaf3:e1-2"]
    #- endpoints: ["spine2:e1-4", "leaf4:e1-2"]

